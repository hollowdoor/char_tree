{"version":3,"file":"bundle.js","sources":["../src/index.js"],"sourcesContent":["import objectAssign from 'object-assign';\n\nexport class CharTree {\n    constructor(){\n        this.tree = {branches: {}, items: []};\n    }\n    empty(){\n        this.tree = {branches: {}, items: []};\n    }\n    push(...datas){\n        datas.forEach(data=>{\n\n            let next = this.tree;\n            let list = data.split('');\n\n            list.forEach(ch=>{\n                let key = ch.toLowerCase();\n                next = (next.branches[key] = next.branches[key] || Object.create(null));\n                next.branches = next.branches || Object.create(null);\n                next.items = next.items || [];\n                next.items.push(data);\n                next.value = ch;\n            });\n\n            next.leaf = true;\n        });\n    }\n    remove(...datas){\n        datas.forEach(data=>{\n            let next = this.tree, last;\n            let list = data.split('');\n\n            for(let i=0; i<list.length; i++){\n                let char = list[i];\n                let key = char.toLowerCase();\n                let index;\n\n                last = next;\n                next = next.branches[key];\n\n                if(next === void 0) break;\n\n                if((index = next.items.indexOf(data.value)) !== -1){\n                    next.items.splice(index, 1);\n                    if(!next.items.length){\n                        delete last.branches[key];\n                    }else{\n                        next = next.branches[key];\n                    }\n                }\n\n            }\n        });\n    }\n    match(value){\n        let list = value.split('').map(v=>v.toLowerCase());\n\n        let next = this.tree,\n            len = list.length + 1,\n            last,\n            string = '';\n\n        if(!list.length) return {tree: null, string, value};\n\n        for(let i=0; i<len; i++){\n            last = next;\n            next = next.branches[list[i]];\n            if(!next){\n                if(list[i] !== void 0) last = null;\n                break;\n            }else{\n                string += next.value;\n            }\n        }\n\n        return {tree: last, string, value};\n    }\n    findAll(value){\n        let {tree} = this.match(value);\n        if(!tree) return [];\n        return [].concat(tree.items);\n    }\n    nextPhrase(value, sep){\n\n        let {tree, string} = this.match(value),\n            result = string;\n\n        const iter = (next)=>{\n\n            if(next.leaf){\n                return result;\n            }\n\n            let keys = Object.keys(next.branches);\n            for(let key in next.branches){\n                if(sep.test(key)){\n                    return result + key;\n                }\n                result += next.branches[key].value;\n                return iter(next.branches[key])\n\n            }\n        };\n\n        return iter(tree);\n    }\n}\n\nfunction lower(item){\n    return item.toLowerCase();\n}\n\nexport function charTreeMixin(dest){\n    return objectAssign(dest, {\n        nextPhrase(value, sep){\n            return this.charTree.nextPhrase(value, sep);\n        },\n        match(value = ''){\n            return this.charTree.match(value);\n        },\n        findAll(value){\n            return this.charTree.findAll(value);\n        },\n        push(...values){\n            values.forEach(value=>{\n                this.charTree.push(value);\n            });\n            return this;\n        },\n        pushAll(values){\n            this.charTree.push(...values);\n        },\n        empty(){\n            this.charTree.empty();\n            return this;\n        },\n        initCharTree(){\n            return this.charTree = new CharTree();\n        }\n    });\n}\n"],"names":["this","let"],"mappings":"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"}